<div class="container my-5 cart-checkout bg-light">
  <div class="row g-4">

    <!-- Cart Summary -->
    <div class="col-lg-6">
      <div class="card shadow-lg  text-dark h-100">
        <div class="card-body">
          <h4 class="card-title fw-bold text-primary mb-3">Cart Summary</h4>

          <!-- Empty Cart -->
          <div *ngIf="cartItems.length === 0" 
               class="alert alert-dark  text-dark text-center fw-semibold">
            Your cart is empty.
          </div>

          <!-- Cart Table -->
          <div *ngIf="cartItems.length > 0" class="table-responsive">
            <table class="table table-bordered align-middle shadow-sm">
              <thead class="bg-light ">
                <tr>
                  <th>Product</th>
                  <th class="text-center">Qty</th>
                  <th class="text-end">Price</th>
                  <th class="text-end">Total</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of cartItems; trackBy: trackByProductId" 
                    class="hover-row">
                  <td>{{ item.productName }}</td>
                  <td class="text-center">{{ item.quantity }}</td>
                  <td class="text-end">${{ formatPrice(item.price) }}</td>
                  <td class="text-end fw-bold text-dark">${{ formatPrice(item.totalPrice) }}</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="3" class="text-end fw-bold">Order Total:</td>
                  <td class="text-end fw-bold text-dark fs-5">
                    ${{ formatPrice(totalAmount()) }}
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Shipping & Payment -->
    <div class="col-lg-6">
      <div class="card shadow-lg h-100">
        <div class="card-body">
          <h4 class="card-title fw-bold text-primary mb-3">Shipping & Payment</h4>

          <form (ngSubmit)="placeOrder()" class="needs-validation" novalidate>

            <!-- Name -->
            <div class="mb-3">
              <label for="name" class="form-label text-dark">Full Name</label>
              <input type="text" id="name" name="name" class="form-control text-dark " 
                     [(ngModel)]="userName" placeholder="John Doe" required>
              <div class="invalid-feedback">Please enter your full name.</div>
            </div>

            <!-- Contact -->
            <div class="mb-3">
              <label for="contact" class="form-label text-dark">Contact Number</label>
              <input type="tel" id="contact" name="contact" class="form-control  text-dark" 
                     [(ngModel)]="contact" placeholder="(123) 456-7890" required>
              <div class="invalid-feedback">Please enter a valid phone number.</div>
            </div>

            <!-- Address -->
            <div class="mb-3">
              <label for="address" class="form-label text-dark">Delivery Address</label>
              <textarea id="address" name="address" class="form-control text-dark" rows="3" 
                        [(ngModel)]="deliveryAddress" placeholder="123 Main St, Anytown, USA" required></textarea>
              <div class="invalid-feedback">Please enter your address.</div>
            </div>

            <!-- Payment -->
            <div class="mb-3">
              <label for="payment" class="form-label text-dark">Mode of Payment</label>
              <select id="payment" name="payment" class="form-select  text-dark " 
                      [(ngModel)]="paymentMethod" required>
                <option value="" disabled selected>Select a payment method</option>
                <option value="Credit Card">Credit Card</option>
                <option value="PayPal">PayPal</option>
                <option value="Cash on Delivery">Cash on Delivery</option>
              </select>
              <div class="invalid-feedback">Please select a payment method.</div>
            </div>

            <!-- Submit -->
            <div class="d-grid">
              <button type="submit" class="btn btn-primary fw-bold btn-lg shadow-sm" 
                      [disabled]="cartItems.length === 0">
                Complete Order
              </button>
            </div>
             <div *ngIf="alertMessage" class="alert alert-{{ alertType }} alert-dismissible fade show mt-2"
                role="alert">
                {{ alertMessage }}
                <button type="button" class="btn-close" (click)="alertMessage = null"></button>
              </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>
